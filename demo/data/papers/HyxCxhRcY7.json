{"title": "DEEP ANOMALY DETECTION WITH OUTLIER EXPOSURE", "authors": "Dan Hendrycks; Mantas Mazeika; Thomas Dietterich", "pub_date": "", "abstract": "It is important to detect anomalous inputs when deploying machine learning systems. The use of larger and more complex inputs in deep learning magnifies the difficulty of distinguishing between anomalous and in-distribution examples. At the same time, diverse image and text data are available in enormous quantities. We propose leveraging these data to improve deep anomaly detection by training anomaly detectors against an auxiliary dataset of outliers, an approach we call Outlier Exposure (OE). This enables anomaly detectors to generalize and detect unseen anomalies. In extensive experiments on natural language processing and small-and large-scale vision tasks, we find that Outlier Exposure significantly improves detection performance. We also observe that cutting-edge generative models trained on CIFAR-10 may assign higher likelihoods to SVHN images than to CIFAR-10 images; we use OE to mitigate this issue. We also analyze the flexibility and robustness of Outlier Exposure, and identify characteristics of the auxiliary dataset that improve performance.", "sections": [{"heading": "INTRODUCTION", "text": "Machine Learning systems in deployment often encounter data that is unlike the model's training data. This can occur in discovering novel astronomical phenomena, finding unknown diseases, or detecting sensor failure. In these situations, models that can detect anomalies (Liu et al., 2018;Emmott et al., 2013) are capable of correctly flagging unusual examples for human intervention, or carefully proceeding with a more conservative fallback policy.\nBehind many machine learning systems are deep learning models (Krizhevsky et al., 2012) which can provide high performance in a variety of applications, so long as the data seen at test time is similar to the training data. However, when there is a distribution mismatch, deep neural network classifiers tend to give high confidence predictions on anomalous test examples . This can invalidate the use of prediction probabilities as calibrated confidence estimates (Guo et al., 2017), and makes detecting anomalous examples doubly important.\nSeveral previous works seek to address these problems by giving deep neural network classifiers a means of assigning anomaly scores to inputs. These scores can then be used for detecting outof-distribution (OOD) examples (Hendrycks & Gimpel, 2017;Lee et al., 2018;Liu et al., 2018). These approaches have been demonstrated to work surprisingly well for complex input spaces, such as images, text, and speech. Moreover, they do not require modeling the full data distribution, but instead can use heuristics for detecting unmodeled phenomena. Several of these methods detect unmodeled phenomena by using representations from only in-distribution data.\nIn this paper, we investigate a complementary method where we train models to detect unmodeled data by learning cues for whether an input is unmodeled. While it is difficult to model the full data distribution, we can learn effective heuristics for detecting out-of-distribution inputs by exposing the model to OOD examples, thus learning a more conservative concept of the inliers and enabling the detection of novel forms of anomalies. We propose leveraging diverse, realistic datasets for this purpose, with a method we call Outlier Exposure (OE). OE provides a simple and effective way to consistently improve existing methods for OOD detection.\nThrough numerous experiments, we extensively evaluate the broad applicability of Outlier Exposure. For multiclass neural networks, we provide thorough results on Computer Vision and Natural Language Processing tasks which show that Outlier Exposure can help anomaly detectors generalize to and perform well on unseen distributions of outliers, even on large-scale images. We also demonstrate that Outlier Exposure provides gains over several existing approaches to out-of-distribution detection. Our results also show the flexibility of Outlier Exposure, as we can train various models with different sources of outlier distributions. Additionally, we establish that Outlier Exposure can make density estimates of OOD samples significantly more useful for OOD detection. Finally, we demonstrate that Outlier Exposure improves the calibration of neural network classifiers in the realistic setting where a fraction of the data is OOD. Our code is made publicly available at https://github.com/hendrycks/outlier-exposure.", "n_publication_ref": 8, "n_figure_ref": 0}, {"heading": "RELATED WORK", "text": "Out-of-Distribution Detection with Deep Networks. Hendrycks & Gimpel (2017) demonstrate that a deep, pre-trained classifier has a lower maximum softmax probability on anomalous examples than in-distribution examples, so a classifier can conveniently double as a consistently useful outof-distribution detector. Building on this work, DeVries & Taylor (2018) attach an auxiliary branch onto a pre-trained classifier and derive a new OOD score from this branch. Liang et al. (2018) present a method which can improve performance of OOD detectors that use a softmax distribution. In particular, they make the maximum softmax probability more discriminative between anomalies and in-distribution examples by pre-processing input data with adversarial perturbations (Goodfellow et al., 2015). Unlike in our work, their parameters are tailored to each source of anomalies. Lee et al. (2018) train a classifier concurrently with a GAN (Radford et al., 2016;Goodfellow et al., 2014), and the classifier is trained to have lower confidence on GAN samples. For each testing distribution of anomalies, they tune the classifier and GAN using samples from that out-distribution, as discussed in Appendix B of their work. Unlike Liang et al. (2018); Lee et al. (2018), in this work we train our method without tuning parameters to fit specific types of anomaly test distributions, so our results are not directly comparable with their results. Many other works (de Vries et al., 2016;Subramanya et al., 2017;Malinin & Gales, 2018;Bevandic et al., 2018) also encourage the model to have lower confidence on anomalous examples. Recently, Liu et al. (2018) provide theoretical guarantees for detecting out-of-distribution examples under the assumption that a suitably powerful anomaly detector is available.\nUtilizing Auxiliary Datasets. Outlier Exposure uses an auxiliary dataset entirely disjoint from test-time data in order to teach the network better representations for anomaly detection. Goodfellow et al. (2015) train on adversarial examples to increased robustness. Salakhutdinov et al. (2011) pre-train unsupervised deep models on a database of web images for stronger features. Radford et al. (2017) train an unsupervised network on a corpus of Amazon reviews for a month in order to obtain quality sentiment representations. Zeiler & Fergus (2014) find that pre-training a network on the large ImageNet database (Russakovsky et al., 2015) endows the network with general representations that are useful in many fine-tuning applications. Chen & Gupta (2015); Mahajan et al. (2018) show that representations learned from images scraped from the nigh unlimited source of search engines and photo-sharing websites improve object detection performance.", "n_publication_ref": 20, "n_figure_ref": 0}, {"heading": "OUTLIER EXPOSURE", "text": "We consider the task of deciding whether or not a sample is from a learned distribution called D in . Samples from D in are called \"in-distribution,\" and otherwise are said to be \"out-of-distribution\" (OOD) or samples from D out . In real applications, it may be difficult to know the distribution of outliers one will encounter in advance. Thus, we consider the realistic setting where D out is unknown. Given a parametrized OOD detector and an Outlier Exposure (OE) dataset D OE out , disjoint from D test out , we train the model to discover signals and learn heuristics to detect whether a query is sampled from D in or D OE out . We find that these heuristics generalize to unseen distributions D out . Deep parametrized anomaly detectors typically leverage learned representations from an auxiliary task, such as classification or density estimation. Given a model f and the original learning objective L, we can thus formalize Outlier Exposure as minimizing the objective\nE (x,y)\u223cDin [L(f (x), y) + \u03bbE x \u223cD OE out [L OE (f (x ), f (x), y)]\n] over the parameters of f . In cases where labeled data is not available, then y can be ignored.\nOutlier Exposure can be applied with many types of data and original tasks. Hence, the specific formulation of L OE is a design choice, and depends on the task at hand and the OOD detector used. For example, when using the maximum softmax probability baseline detector (Hendrycks & Gimpel, 2017), we set L OE to the cross-entropy from f (x ) to the uniform distribution (Lee et al., 2018). When the original objective L is density estimation and labels are not available, we set L OE to a margin ranking loss on the log probabilities f (x ) and f (x).", "n_publication_ref": 2, "n_figure_ref": 0}, {"heading": "EXPERIMENTS", "text": "We evaluate OOD detectors with and without OE on a wide range of datasets. Each evaluation consists of an in-distribution dataset D in used to train an initial model, a dataset of anomalous examples D OE out , and a baseline detector to which we apply OE. We describe the datasets in Section 4.2. The OOD detectors and L OE losses are described on a case-by-case basis.\nIn the first experiment, we show that OE can help detectors generalize to new text and image anomalies. This is all accomplished without assuming access to the test distribution during training or tuning, unlike much previous work. In the confidence branch experiment, we show that OE is flexible and complements a binary anomaly detector. Then we demonstrate that using synthetic outliers does not work as well as using real and diverse data; previously it was assumed that we need synthetic data or carefully selected close-to-distribution data, but real and diverse data is enough. We conclude with experiments in density estimation. In these experiments we find that a cutting-edge density estimator unexpectedly assigns higher density to out-of-distribution samples than in-distribution samples, and we ameliorate this surprising behavior with Outlier Exposure.  We evaluate out-of-distribution detection methods on their ability to detect OOD points. For this purpose, we treat the OOD examples as the positive class, and we evaluate three metrics: area under the receiver operating characteristic curve (AUROC), area under the precision-recall curve (AUPR), and the false positive rate at N % true positive rate (FPRN ). The AUROC and AUPR are holistic metrics that summarize the performance of a detection method across multiple thresholds. The AUROC can be thought of as the probability that an anomalous example is given a higher OOD score than a in-distribution example (Davis & Goadrich, 2006). Thus, a higher AUROC is better, and an uninformative detector has an AUROC of 50%. The AUPR is useful when anomalous examples are infrequent (Manning & Sch\u00fctze, 1999), as it takes the base rate of anomalies into account. During evaluation with these metrics, the base rate of D test out to D test in test examples in all of our experiments is 1:5.\nWhereas the previous two metrics represent the detection performance across various thresholds, the FPRN metric represents performance at one strict threshold. By observing performance at a strict threshold, we can make clear comparisons among strong detectors. The FPRN metric (Liu et al., 2018;Kumar et al., 2016;Balntas et al., 2016) is the probability that an in-distribution example (negative) raises a false alarm when N % of anomalous examples (positive) are detected, so a lower FPRN is better. Capturing nearly all anomalies with few false alarms can be of high practical value.", "n_publication_ref": 5, "n_figure_ref": 0}, {"heading": "DATASETS", "text": "", "n_publication_ref": 0, "n_figure_ref": 0}, {"heading": "IN-DISTRIBUTION DATASETS", "text": "SVHN. The SVHN dataset (Netzer et al., 2011) contains 32 \u00d7 32 color images of house numbers. There are ten classes comprised of the digits 0-9. The training set has 604, 388 images, and the test set has 26, 032 images. For preprocessing, we rescale the pixels to be in the interval [0, 1]. CIFAR. The two CIFAR (Krizhevsky & Hinton, 2009) datasets contain 32 \u00d7 32 natural color images. CIFAR-10 has ten classes while CIFAR-100 has 100. CIFAR-10 and CIFAR-100 classes are disjoint but have similiarities. For example, CIFAR-10 has \"automobiles\" and \"trucks\" but not CIFAR-100's \"pickup truck\" class. Both have 50, 000 training images and 10, 000 test images. For this and the remaining image datasets, each image is standardized channel-wise. Tiny ImageNet. The Tiny ImageNet dataset (Johnson et al.) is a 200-class subset of the ImageNet (Russakovsky et al., 2015) dataset where images are resized and cropped to 64 \u00d7 64 resolution. The dataset's images were cropped using bounding box information so that cropped images contain the target, unlike Downsampled ImageNet (Chrabaszcz et al., 2017). The training set has 100, 000 images and the test set has 10, 000 images. Places365. The Places365 training dataset (Zhou et al., 2017)  For classification tasks on 20 Newsgroups, TREC, and SST, we treat each sentence of WikiText-2 as an individual example, and use simple filters to remove low-quality sentences.", "n_publication_ref": 5, "n_figure_ref": 0}, {"heading": "MULTICLASS CLASSIFICATION", "text": "In what follows, we use Outlier Exposure to enhance the performance of existing OOD detection techniques with multiclass classification as the original task. Throughout the following experiments, we let x \u2208 X be a classifier's input and y \u2208 Y = {1, 2, . . . , k} be a class. We also represent the classifier with the function f : X \u2192 R k , such that for any x, 1 T f (x) = 1 and f (x) 0.", "n_publication_ref": 0, "n_figure_ref": 0}, {"heading": "Maximum Softmax Probability (MSP).", "text": "Consider the maximum softmax probability baseline (Hendrycks & Gimpel, 2017) which gives an input x the OOD score \u2212 max c f c (x). Out-ofdistribution samples are drawn from various unseen distributions (Appendix A). For each task, we test with approximately twice the number of D test out distributions compared to most other papers, and we also test on NLP tasks. The quality of the OOD example scores are judged with the metrics described in Section 4.1. For this multiclass setting, we perform Outlier Exposure by fine-tuning a pre-trained classifier f so that its posterior is more uniform on D OE out samples. Specifically, the fine-\ntuning objective is E (x,y)\u223cDin [\u2212 log f y (x)] + \u03bbE x\u223cD OE out [H(U; f (x))]\n, where H is the cross entropy and U is the uniform distribution over k classes. When there is class imbalance, we could encourage f (x) to match (P (y = 1), . . . , P (y = k)); yet for the datasets we consider, matching U works well enough. Also, note that training from scratch with OE can result in even better performance than fine-tuning (Appendix C). This approach works on different architectures as well (Appendix D).\nUnlike Liang et al. (2018); Lee et al. (2018) and like Hendrycks & Gimpel (2017); DeVries & Taylor (2018), we do not tune our hyperparameters for each D test out distribution, so that D test out is kept unknown like with real-world anomalies. Instead, the \u03bb coefficients were determined early in experimentation with validation D val out distributions described in Appendix A. In particular, we use \u03bb = 0.5 for vision experiments and \u03bb = 1.0 for NLP experiments. Like previous OOD detection methods involving network fine-tuning, we chose \u03bb so that impact on classification accuracy is negligible.\nFor nearly all of the vision experiments, we train Wide Residual Networks (Zagoruyko & Komodakis, 2016) and then fine-tune network copies with OE for 10 epochs. However we use a pretrained ResNet-18 for Places365. For NLP experiments, we train 2-layer GRUs (Cho et al., 2014) for 5 epochs, then fine-tune network copies with OE for 2 epochs. Networks trained on CIFAR-10 or CIFAR-100 are exposed to images from 80 Million Tiny Images, and the Tiny ImageNet and Places365 classifiers are exposed to ImageNet-22K. NLP classifiers are exposed to WikiText-2. Further architectural and training details are in Appendix B. For all tasks, OE improves average performance by a large margin. Averaged results are shown in Tables 1 and 2. Sample ROC curves are shown in Figures 1 and 4. Detailed results on individual D test out datasets are in Table 7 and Table (Hafner et al., 2018). A method with better success is from Lee et al. (2018). They carefully train a GAN to generate synthetic examples near the classifier's decision boundary. The classifier is encouraged to have a low maximum softmax probability on these synthetic examples. For CIFAR classifiers, they mention that a GAN can be a better source of anomalies than datasets such as SVHN. In contrast, we find that the simpler approach of drawing anomalies from a diverse dataset is sufficient for marked improvements in OOD detection.\nWe train a 40-4 Wide Residual Network using Lee et al. (2018)'s publicly available code, and use the network's maximum softmax probabilities as our baseline. Another classifier trains concurrently with a GAN so that the classifier assigns GAN-generated examples a high OOD score. We want each D test out to be novel. Consequently we use their code's default hyperparameters, and exactly one model encounters all tested D test out distributions. This is unlike their work since, for each D test out distribution, they train and tune a new network. We do not evaluate on Tiny ImageNet, Places365, nor text, since DCGANs cannot stably generate such images and text reliably. Lastly, we take the network trained in tandem with a GAN and fine-tune it with OE. Table 4 shows the large gains from using OE with a real and diverse dataset over using synthetic samples from a GAN.    (Nalisnick et al., 2019). Consequently, density estimates are another means by which to score anomalies (Zong et al., 2018). We show the ability of OE to improve density estimates on low-probability, outlying data.\nPixelCNN++. Autoregressive neural density estimators provide a way to parametrize the probability density of image data. Although sampling from these architectures is slow, they allow for evaluating the probability density with a single forward pass through a CNN, making them promising candidates for OOD detection. We use Pix-elCNN++ (Salimans et al., 2017) as a baseline OOD detector, and we train it on CIFAR-10. The OOD score of example x is the bits per pixel (BPP), defined as nll(x)/num_pixels, where nll is the negative log-likelihood. With this loss we fine-tune for 2 epochs using OE, which we find is sufficient for the training loss to converge. Here OE is implemented with a margin loss over the log-likelihood difference between in-distribution and anomalous examples, so that the loss for a sample x in from D in and point x out from D OE out is max{0, num_pixels + nll(x in ) \u2212 nll(x out )}.\nResults are shown in Table 5. Notice that PixelCNN++ without OE unexpectedly assigns lower BPP from SVHN images than CIFAR-10 images. For all D test out datasets, OE significantly improves results. Language Modeling. We next explore using OE on language models. We use QRNN (Merity et al., 2018a;b) language models as baseline OOD detectors. For the OOD score, we use bits per character (BPC) or bits per word (BPW), defined as nll(x)/sequence_length, where nll(x) is the negative log-likelihood of the sequence x. Outlier Exposure is implemented by adding the cross entropy to the uniform distribution on tokens from sequences in D OE out as an additional loss term. For D in , we convert the language-modeling version of Penn Treebank, split into sequences of length 70 for backpropagation for word-level models, and 150 for character-level models. We do not train or evaluate with preserved hidden states as in BPTT. This is because retaining hidden states would greatly simplify the task of OOD detection. Accordingly, the OOD detection task is to provide a score for 70-or 150-token sequences in the unseen D test out datasets. We train word-level models for 300 epochs, and character-level models for 50 epochs. We then fine-tune using OE on WikiText-2 for 5 epochs. For the character-level language model, we create a character-level version of WikiText-2 by converting words to lowercase and leaving out characters which do not appear in PTB. OOD detection results for the word-level and character-level language models are shown in \nFPR95 \u2193 AUROC \u2191 AUPR \u2191 D in D", "n_publication_ref": 14, "n_figure_ref": 1}, {"heading": "DISCUSSION", "text": "Extensions to Multilabel Classifiers and the Reject Option. Outlier Exposure can work in more classification regimes than just those considered above. For example, a multilabel classifier trained on CIFAR-10 obtains an 88.8% mean AUROC when using the maximum prediction probability as the OOD score. By training with OE to decrease the classifier's output probabilities on OOD samples, the mean AUROC increases to 97.1%. This is slightly less than the AUROC for a multiclass model tuned with OE. An alternative OOD detection formulation is to give classifiers a \"reject class\" (Bartlett & Wegkamp, 2008). Outlier Exposure is also flexible enough to improve performance in this setting, but we find that even with OE, classifiers with the reject option or multilabel outputs are not as competitive as OOD detectors with multiclass outputs.\nFlexibility in Choosing D OE out . Early in experimentation, we found that the choice of D OE out is important for generalization to unseen D test out distributions. For example, adding Gaussian noise to samples from D in to create D OE out does not teach the network to generalize to unseen anomaly distributions for complex D in . Similarly, we found in Section 4.3 that synthetic anomalies do not work as well as real data for D OE out . In contrast, our experiments demonstrate that the large datasets of realistic anomalies described in Section 4.2.2 do generalize to unseen D test out distributions. In addition to size and realism, we found diversity of D OE out to be an important factor. Concretely, a CIFAR-100 classifier with CIFAR-10 as D OE out hardly improves over the baseline. A CIFAR-10 classifier exposed to ten CIFAR-100 outlier classes corresponds to an average AUPR of 78.5%. Exposed to 30 such classes, the classifier's average AUPR becomes 85.1%. Next, 50 classes corresponds to 85.3%, and from thereon additional CIFAR-100 classes barely improve performance. This suggests that dataset diversity is important, not just size. In fact, experiments in this paper often used around 1% of the images in the 80 Million Tiny Images dataset since we only briefly fine-tuned the models. We also found that using only 50,000 examples from this dataset led to a negligible degradation in detection performance. Additionally, D OE out datasets with significantly different statistics can perform similarly. For instance, using the Project Gutenberg dataset in lieu of WikiText-2 for D OE out in the SST experiments gives an average AUROC of 90.1% instead of 89.3%.", "n_publication_ref": 1, "n_figure_ref": 0}, {"heading": "Closeness of D test", "text": "out , D OE out , and D test in . Our experiments show several interesting effects of the closeness of the datasets involved. Firstly, we find that D test out and D OE out need not be close for training with OE to improve performance on D test out . In Appendix A, we observe that an OOD detector for SVHN has its performance improve with Outlier Exposure even though (1) D OE out samples are images of natural scenes rather than digits, and (2) D test out includes unnatural examples such as emojis. We observed the same in our preliminary experiments with MNIST; using 80 Million Tiny Images as D OE out , OE increased the AUPR from 94.2% to 97.0%.\nSecondly, we find that the closeness of D OE out to D test in can be an important factor in the success of OE. In the NLP experiments, preprocessing D OE out to be closer to D in improves OOD detection performance significantly. Without preprocessing, the network may discover easy-to-learn cues which reveal whether the input is in-or out-of-distribution, so the OE training objective can be optimized in unintended ways. That results in weaker detectors. In a separate experiment, we use Online Hard Example Mining so that difficult outliers have more weight in Outlier Exposure. Although this improves performance on the hardest anomalies, anomalies without plausible local statistics like noise are detected slightly less effectively than before. Thus hard or close-to-distribution examples do not necessarily teach the detector all valuable heuristics for detecting various forms of anomalies. Real-world applications of OE could use the method of Sun et al. (2018)   OE Improves Calibration. When using classifiers for prediction, it is important that confidence estimates given for the predictions do not misrepresent empirical performance. A calibrated classifier gives confidence probabilities that match the empirical frequency of correctness. That is, if a calibrated model predicts an event with 30% probability, then 30% of the time the event transpires.\nExisting confidence calibration approaches consider the standard setting where data at test-time is always drawn from D in . We extend this setting to include examples from D test out at test-time since systems should provide calibrated probabilities on both in-and out-of-distribution samples. The classifier should have low-confidence predictions on these OOD examples, since they do not have a class. Building on the temperature tuning method of Guo et al. (2017), we demonstrate that OE can improve calibration performance in this realistic setting. Summary results are shown in Figure 3. Detailed results and a description of the metrics are in Appendix G.", "n_publication_ref": 2, "n_figure_ref": 1}, {"heading": "CONCLUSION", "text": "In this paper, we proposed Outlier Exposure, a simple technique that enhances many current OOD detectors across various settings. It uses out-of-distribution samples to teach a network heuristics to detect new, unmodeled, out-of-distribution examples. We showed that this method is broadly applicable in vision and natural language settings, even for large-scale image tasks. OE can improve model calibration and several previous anomaly detection techniques. Further, OE can teach density estimation models to assign more plausible densities to out-of-distribution samples. Finally, Outlier Exposure is computationally inexpensive, and it can be applied with low overhead to existing systems. In summary, Outlier Exposure is an effective and complementary approach for enhancing out-of-distribution detection systems.", "n_publication_ref": 0, "n_figure_ref": 0}, {"heading": "A EXPANDED MULTICLASS RESULTS", "text": "Expanded mutliclass out-of-distribution detection results are in Table 7 and Table 8   Anomalous Data. For each in-distribution dataset D in , we comprehensively evaluate OOD detectors on artificial and real anomalous distributions D test out following Hendrycks & Gimpel (2017). For each learned distribution D in , the number of test distributions that we compare against is approximately double that of most previous works.\nGaussian anomalies have each dimension i.i.d. sampled from an isotropic Gaussian distribution. Rademacher anomalies are images where each dimension is \u22121 or 1 with equal probability, so each dimension is sampled from a symmetric Rademacher distribution. Bernoulli images have each pixel sampled from a Bernoulli distribution if the input range is [0, 1]. Blobs data consist in algorithmically generated amorphous shapes with definite edges. Icons-50 is a dataset of icons and emojis (Hendrycks & Dietterich, 2019); icons from the \"Number\" class are removed. Textures is a dataset of describable textural images (Cimpoi et al., 2014). Places365 consists in images for scene recognition rather than object recognition (Zhou et al., 2017). LSUN is another scene understanding dataset with fewer classes than Places365 (Yu et al., 2015). ImageNet anomalous examples are taken from the 800 ImageNet-1K classes disjoint from Tiny ImageNet's 200 classes, and when possible each image is cropped with bounding box information as in Tiny ImageNet. For the Places365 experiment, ImageNet is ImageNet-1K with all 1000 classes. With CIFAR-10 as D in , we use also CIFAR-100 as D test out and vice versa; recall that the CIFAR-10 and CIFAR-100 classes do not overlap. Chars74K is a dataset of photographed characters in various styles; digits and letters such as \"O\" and \"l\" were removed since they can look like numbers. Places69 has images from 69 scene categories not found in the Places365 dataset.\nSNLI is a dataset of predicates and hypotheses for natural language inference. We use the hypotheses for D OE out . IMDB is a sentiment classification dataset of movie reviews, with similar statistics to those of SST. Multi30K is a dataset of English-German image descriptions, of which we use the English descriptions. WMT16 is the English portion of the test set from WMT16. Yelp is a dataset of restaurant reviews. English Web Treebank (EWT) consists of five individual datasets: Answers (A), Email (E), Newsgroups (N), Reviews (R), and Weblog (W). Each contains examples from the indicated domain.\nValidation Data. For each experiment, we create a set of validation distributions D val out . The first anomalies are uniform noise anomalies where each pixel is sampled from U[0, 1] or U[\u22121, 1] depending on the input space of the classifier. The remaining D val out validation sources are generated by corrupting in-distribution data, so that the data becomes out-of-distribution. One such source of anomalies is created by taking the pixelwise arithmetic mean of a random pair of in-distribution images. Other anomalies are created by taking the geometric mean of a random pair of in-distribution images. Jigsaw anomalies are created by taking an in-distribution example, partitioning the image into 16 equally sized patches, and permuting those patches. Speckle Noised anomalies are created by applying speckle noise to in-distribution images. RGB Ghosted anomalies involves shifting and reordering the color channels of in-distribution images. Inverted images are anomalies which have some or all of their color channels inverted.", "n_publication_ref": 5, "n_figure_ref": 0}, {"heading": "B ARCHITECTURES AND TRAINING DETAILS", "text": "For CIFAR-10, CIFAR-100, and Tiny ImageNet classification experiments, we use a 40-2 Wide Residual Network (Zagoruyko & Komodakis, 2016). The network trains for 100 epochs with a dropout rate of 0.3. The initial learning rate of 0.1 decays following a cosine learning rate schedule . During fine-tuning of the entire network, we again use a cosine learning rate schedule but with an initial learning rate of 0.001. We use standard flipping and data cropping augmentation, Nesterov momentum, and 2 weight decay with a coefficient of 5 \u00d7 10 \u22124 . SVHN architectures are 16-4 Wide ResNets trained for 20 epochs with an initial learning rate of 0.01 and no data augmentation. For Places365, we use a ResNet-18 pre-trained on Places365. In this Places365 experiment, we tune with Outlier Exposure for 5 epochs, use 512 outlier samples per iteration, and start with a learning rate of 0.0001. Outlier Exposure fine-tuning occurs with each epoch being the length of in-distribution dataset epoch, so that Outlier Exposure completes quickly and does involve reading the entire D OE out dataset. ", "n_publication_ref": 1, "n_figure_ref": 0}, {"heading": "D OE WORKS ON OTHER VISION ARCHITECTURES", "text": "Outlier Exposure also improves vision OOD detection performance for more than just Wide ResNets. Table 9 shows that Outlier Exposure also improves vision OOD detection performance for \"All Convolutional Networks\" (Salimans & Kingma, 2016 ", "n_publication_ref": 1, "n_figure_ref": 0}, {"heading": "G CONFIDENCE CALIBRATION", "text": "Models integrated into a decision making process should indicate when they are trustworthy, and such models should not have inordinate confidence in their predictions. In an effort to combat a false sense of certainty from overconfident models, we aim to calibrate model confidence. A model is calibrated if its predicted probabilities match empirical frequencies. Thus if a calibrated model predicts an event with 30% probability, then 30% of the time the event transpires. Prior research (Guo et al., 2017;Nguyen & O'Connor, 2015;Kuleshov & Liang, 2015) considers calibrating systems where test-time queries are samples from D in , but systems also encounter samples from D test out and should also ascribe low confidence to these samples. Hence, we use OE to control the confidence on these samples.", "n_publication_ref": 3, "n_figure_ref": 0}, {"heading": "G.1 METRICS", "text": "In order to evaluate a multiclass classifier's calibration, we present three metrics. First we establish context. For input example X \u2208 X , let Y \u2208 Y = {1, 2, . . . , k} be the ground truth class. Let Y be the model's class prediction, and let C be the corresponding model confidence or prediction probability. Denote the set of prediction-label pairs made by the model with S = {( y 1 , c 1 ), ( y 2 , c 2 ), . . . , ( y n , c n )}. ", "n_publication_ref": 0, "n_figure_ref": 0}, {"heading": "RMS and MAD Calibration Error", "text": "b i=1 |B i | n 1 |B i | k\u2208Bi 1(y k = y k ) \u2212 1 |B i | k\u2208Bi c k 2 .\nAlong similar lines, the MAD Calibration Error-which is an improper scoring rule due to its use of absolute differences rather than squared differences-is estimated with\nb i=1 |B i | n 1 |B i | k\u2208Bi 1(y k = y k ) \u2212 1 |B i | k\u2208Bi c k .\nSoft F1 Score. If a classifier makes only a few mistakes, then most examples should have high confidence. But if the classifier gives all predictions high confidence, including its mistakes, then the previous metrics will indicate that the model is calibrated on the vast majority of instances, despite having systematic miscalibration. The Soft F1 score (Pastor-Pellicer et al., 2013;Hendrycks & Gimpel, 2017) is suited for measuring the calibration of a system where there is an acute imbalance between mistaken and correct decisions. Since we treat mistakes a positive examples, we can write the model's confidence that the examples are anomalous with c a = (1 \u2212 c 1 , 1 \u2212 c 2 , . . . , 1 \u2212 c n ). To indicate that an example is positive (mistaken), we use the vector m \u2208 {0, 1} n such that m i = 1(y i = y i ) for 1 \u2264 i \u2264 n. Then the Soft F1 score is c T a m 1 T (c a + m)/2 . ", "n_publication_ref": 2, "n_figure_ref": 0}, {"heading": "G.2 SETUP AND RESULTS", "text": "There are many ways to estimate a classifier's confidence. One way is to bind a logistic regression branch onto the network, so that confidence values are in [0, 1]. Other confidence estimates use the model's logits l \u2208 R k , such as the estimate \u03c3(max i l i ) \u2208 [0, 1], where \u03c3 is the logistic sigmoid.\nAnother common confidence estimate is max i exp (l i )/ k j=1 exp (l j ) . A modification of this estimate is our baseline. Softmax Temperature Tuning. Guo et al. (2017) show that good calibration can be obtained by including a tuned temperature parameter into the softmax: p(y = i | x) = exp(l i /T )/ k j=1 exp(l j /T ). We tune T to maximize log likelihood on a validation set after the network has been trained on the training set.\nResults. In this calibration experiment, the baseline is confidence estimation with softmax temperature tuning. Therefore, we train SVHN, CIFAR-10, CIFAR-100, and Tiny ImageNet classifiers with 5000, 5000, 5000, and 10000 training examples held out, respectively. A copy of this classifier is fine-tuned with Outlier Exposure. Then we determine the optimal temperatures of the original and OE-fine-tuned classifiers on the held-out examples. To measure calibration, we take equally many examples from a given in-distribution dataset D test in and OOD dataset D test out . Out-of-distribution points are understood to be incorrectly classified since their label is not in the model's output space, so calibrated models should assign these out-of-distribution points low confidence. Results are in Table 12. Outlier Exposure noticeably improves model calibration.", "n_publication_ref": 1, "n_figure_ref": 0}, {"heading": "G.3 POSTERIOR RESCALING", "text": "While temperature tuning improves calibration, the confidence estimate p(y = i | x) cannot be less than 1/k, k the number of classes. For an out-of-distribution example like Gaussian Noise, a good model should have no confidence in its prediction over k classes. One possibility is to add a reject option, or a (k + 1)st class, which we cover in Section 5. A simpler option we found is to perform an affine transformation of p(y = i | x) \u2208 [1/k, 1] with the formula ( p(y = i | x) \u2212 1/k)/(1 \u2212 1/k) \u2208 [0, 1]. This simple transformation makes it possible for a network to express no confidence on an out-of-distribution input and improves calibration performance. As Table 13 shows, this simple 0-1 posterior rescaling technique consistently improves calibration, and the model fine-tuned with OE using temperature tuning and posterior rescaling achieved large calibration improvements.   In Figure 4, we show additional PR and ROC Curves using the Tiny ImageNet dataset and various anomalous distributions.", "n_publication_ref": 0, "n_figure_ref": 1}, {"heading": "ACKNOWLEDGMENTS", "text": "We thank NVIDIA for donating GPUs used in this research. This research was supported by a grant from the Future of Life Institute.", "n_publication_ref": 0, "n_figure_ref": 0}], "references": [{"title": "Learning local feature descriptors with triplets and shallow convolutional neural networks. British Machine Vision Conference", "journal": "", "year": "2016", "authors": "Vassileios Balntas; Edgar Riba; Daniel Ponsa; Krystian Mikolajczyk"}, {"title": "Classification with a reject option using a hinge loss", "journal": "Journal of Machine Learning Research", "year": "2008", "authors": "L Peter; Marten H Bartlett;  Wegkamp"}, {"title": "Discriminative out-of-distribution detection for semantic segmentation", "journal": "", "year": "2018", "authors": "Petra Bevandic; Sinisa Segvic; Ivan Kreso; Marin Orsic"}, {"title": "", "journal": "", "year": "2012", "authors": "Ann Bies; Justin Mott; Colin Warner; Seth Kulick"}, {"title": "Webly supervised learning of convolutional networks", "journal": "", "year": "2015", "authors": "Xinlei Chen; Abhinav Gupta"}, {"title": "Learning phrase representations using rnn encoder-decoder for statistical machine translation", "journal": "", "year": "2014", "authors": "Kyunghyun Cho; Bart Van Merrienboer; Caglar Gulcehre; Dzmitry Bahdanau; Fethi Bougares; Holger Schwenk; Yoshua Bengio"}, {"title": "A downsampled variant of imagenet as an alternative to the cifar datasets", "journal": "", "year": "2017", "authors": "Patryk Chrabaszcz; Ilya Loshchilov; Frank Hutter"}, {"title": "Describing textures in the wild. Computer Vision and Pattern Recognition", "journal": "", "year": "2014", "authors": "Mircea Cimpoi; Subhransu Maji; Iasonas Kokkinos; Sammy Mohamed; Andrea Vedaldi"}, {"title": "The relationship between precision-recall and ROC curves", "journal": "", "year": "2006", "authors": "Jesse Davis; Mark Goadrich"}, {"title": "Deep learning vector quantization", "journal": "", "year": "2016", "authors": "Roland Harm De Vries; Aaron Memisevic;  Courville"}, {"title": "Learning confidence for out-of-distribution detection in neural networks", "journal": "", "year": "2018", "authors": "Terrance Devries; W Graham;  Taylor"}, {"title": "Systematic construction of anomaly detection benchmarks from real data", "journal": "ACM", "year": "2013", "authors": "F Andrew; Shubhomoy Emmott; Thomas Das; Alan Dietterich; Weng-Keen Fern;  Wong"}, {"title": "Generative adversarial networks. Neural Information Processing Systems", "journal": "", "year": "2014", "authors": "Ian Goodfellow; Jean Pouget-Abadie; Mehdi Mirza; Bing Xu; David Warde-Farley; Sherjil Ozair; Aaron Courville; Yoshua Bengio"}, {"title": "Explaining and harnessing adversarial examples", "journal": "", "year": "2015", "authors": "Ian J Goodfellow; Jonathon Shlens; Christian Szegedy"}, {"title": "On calibration of modern neural networks. International Conference on Machine Learning", "journal": "", "year": "2017", "authors": "Chuan Guo; Geoff Pleiss; Yu Sun; Kilian Q Weinberger"}, {"title": "Reliable uncertainty estimates in deep neural networks using noise contrastive priors. International Conference on Machine Learning Workshop", "journal": "", "year": "2018", "authors": "Danijar Hafner; Dustin Tran; Alex Irpan; Timothy Lillicrap; James Davidson"}, {"title": "Benchmarking neural network robustness to common corruptions and perturbations", "journal": "", "year": "2019", "authors": "Dan Hendrycks; Thomas Dietterich"}, {"title": "A baseline for detecting misclassified and out-of-distribution examples in neural networks", "journal": "", "year": "2017", "authors": "Dan Hendrycks; Kevin Gimpel"}, {"title": "Tiny imagenet visual recognition challenge", "journal": "", "year": "", "authors": "Johnson "}, {"title": "Learning multiple layers of features from tiny images", "journal": "", "year": "2009", "authors": "Alex Krizhevsky; Geoffrey Hinton"}, {"title": "Imagenet classification with deep convolutional neural networks", "journal": "", "year": "2012", "authors": "Alex Krizhevsky; Ilya Sutskever; Geoffrey E Hinton"}, {"title": "Calibrated structured prediction. Neural Information Processing Systems", "journal": "", "year": "2015", "authors": "Volodymyr Kuleshov; Percy Liang"}, {"title": "Learning local image descriptors with deep siamese and triplet convolutional networks by minimizing global loss functions. Computer Vision and Pattern Recognition", "journal": "", "year": "2016", "authors": "Vijay Kumar; Gustavo Carneiro; Ian Reid"}, {"title": "Training confidence-calibrated classifiers for detecting out-of-distribution samples", "journal": "", "year": "2018", "authors": "Kimin Lee; Honglak Lee; Kibok Lee; Jinwoo Shin"}, {"title": "Enhancing the reliability of out-of-distribution image detection in neural networks", "journal": "", "year": "2018", "authors": "Shiyu Liang; Yixuan Li; R Srikant"}, {"title": "Open category detection with PAC guarantees", "journal": "", "year": "2018", "authors": "Si Liu; Risheek Garrepalli; Thomas Dietterich; Alan Fern; Dan Hendrycks"}, {"title": "Sgdr: Stochastic gradient descent with warm restarts", "journal": "", "year": "2017", "authors": "Ilya Loshchilov; Frank Hutter"}, {"title": "Ashwin Bharambe, and Laurens van der Maaten. Exploring the limits of weakly supervised pretraining", "journal": "", "year": "2018", "authors": "Dhruv Mahajan; Ross Girshick; Vignesh Ramanathan; Kaiming He; Manohar Paluri; Yixuan Li"}, {"title": "Predictive uncertainty estimation via prior networks", "journal": "", "year": "2018", "authors": "Andrey Malinin; Mark Gales"}, {"title": "Foundations of Statistical Natural Language Processing", "journal": "MIT Press", "year": "1999", "authors": "Chris Manning; Hinrich Sch\u00fctze"}, {"title": "Regularizing and Optimizing LSTM Language Models. International Conference on Learning Representations", "journal": "", "year": "2018", "authors": "Stephen Merity; Nitish Shirish Keskar; Richard Socher"}, {"title": "An Analysis of Neural Language Modeling at Multiple Scales", "journal": "", "year": "2018", "authors": "Stephen Merity; Nitish Shirish Keskar; Richard Socher"}, {"title": "Do deep generative models know what they don't know? International Conference on Learning Representations", "journal": "", "year": "2019", "authors": "Eric Nalisnick; Akihiro Matsukawa; Yee Whye Teh; Dilan Gorur; Balaji Lakshminarayanan"}, {"title": "Reading digits in natural images with unsupervised feature learning", "journal": "", "year": "2011", "authors": "Yuval Netzer; Tao Wang; Adam Coates; Alessandro Bissacco; Bo Wu; Andrew Y Ng"}, {"title": "Deep neural networks are easily fooled: High confidence predictions for unrecognizable images", "journal": "", "year": "2015", "authors": "Anh Nguyen; Jason Yosinski; Jeff Clune"}, {"title": "Posterior calibration and exploratory analysis for natural language processing models", "journal": "", "year": "2015", "authors": "Khanh Nguyen; O' Brendan;  Connor"}, {"title": "F-measure as the error function to train neural networks", "journal": "", "year": "2013", "authors": "Joan Pastor-Pellicer; Francisco Zamora-Mart\u00ednez; Salvador Espa\u00f1a-Boquera; Mar\u00eda Jos\u00e9 Castro-Bleda"}, {"title": "Unsupervised representation learning with deep convolutional generative adversarial networks", "journal": "", "year": "2016", "authors": "Alec Radford; Luke Metz; Soumith Chintala"}, {"title": "Learning to generate reviews and discovering sentiment", "journal": "", "year": "2017", "authors": "Alec Radford; Rafal Jozefowicz; Ilya Sutskever"}, {"title": "Imagenet large scale visual recognition challenge", "journal": "International Journal of Computer Vision", "year": "2015", "authors": "Olga Russakovsky; Jia Deng; Hao Su; Jonathan Krause; Sanjeev Satheesh; Sean Ma; Zhiheng Huang; Andrej Karpathy; Aditya Khosla; Michael Bernstein"}, {"title": "Learning to learn with compound hd models", "journal": "", "year": "2011", "authors": "Ruslan Salakhutdinov; Joshua Tenenbaum; Antonio Torralba"}, {"title": "Weight normalization: A simple reparameterization to accelerate training of deep neural networks", "journal": "NIPS", "year": "2016", "authors": "Tim Salimans; Diederik Kingma"}, {"title": "PixelCNN++: Improving the PixelCNN with discretized logistic mixture likelihood and other modifications", "journal": "", "year": "2017", "authors": "Tim Salimans; Andrej Karpathy; Xi Chen; Diederik P Kingma"}, {"title": "Recursive deep models for semantic compositionality over a sentiment treebank", "journal": "", "year": "2013", "authors": "Richard Socher; Alex Perelygin; Jean Wu; Jason Chuang; Christopher Manning; Andrew Ng; Christopher Potts"}, {"title": "Confidence estimation in deep neural networks via density modelling", "journal": "", "year": "2017", "authors": "Akshayvarun Subramanya; Suraj Srinivas; R Venkatesh;  Babu"}, {"title": "Large scale fine-grained categorization and the effectiveness of domain-specific transfer learning", "journal": "", "year": "2018", "authors": "Chen Sun; Abhinav Shrivastava; Saurabh Singh; Abhinav Gupta"}, {"title": "80 million tiny images: A large data set for nonparametric object and scene recognition. Pattern Analysis and Machine Intelligence", "journal": "", "year": "2008", "authors": "Antonio Torralba; Rob Fergus; William T Freeman"}, {"title": "LSUN: construction of a large-scale image dataset using deep learning with humans in the loop", "journal": "CoRR", "year": "2015", "authors": "Fisher Yu; Yinda Zhang; Shuran Song; Ari Seff; Jianxiong Xiao"}, {"title": "Wide residual networks. British Machine Vision Conference", "journal": "", "year": "2016", "authors": "Sergey Zagoruyko; Nikos Komodakis"}, {"title": "Visualizing and understanding convolutional networks", "journal": "Springer", "year": "2014", "authors": "D Matthew; Rob Zeiler;  Fergus"}, {"title": "Places: A 10 million image database for scene recognition. Pattern Analysis and Machine Intelligence", "journal": "", "year": "2017", "authors": "Bolei Zhou; Agata Lapedriza; Aditya Khosla; Aude Oliva; Antonio Torralba"}, {"title": "Deep autoencoding gaussian mixture model for unsupervised anomaly detection", "journal": "", "year": "2018", "authors": "Bo Zong; Qi Song; Wei Martin Renqiang Min; Cristian Cheng; Daeki Lumezanu; Haifeng Cho;  Chen"}], "figures": [{"figure_label": "1", "figure_type": "", "figure_id": "fig_1", "figure_caption": "Figure 1 :1Figure 1: ROC curve with Tiny Im-ageNet (D in ) and Textures (D test out ).", "figure_data": ""}, {"figure_label": "2", "figure_type": "", "figure_id": "fig_3", "figure_caption": "Figure 2 :2Figure 2: OOD scores from PixelCNN++ on images from CIFAR-10 and SVHN.", "figure_data": ""}, {"figure_label": "", "figure_type": "", "figure_id": "fig_4", "figure_caption": "to refine a scraped D OE out auxiliary dataset to be appropriately close to D test in .SV HN CI FA R-10 CI FA R", "figure_data": ""}, {"figure_label": "3", "figure_type": "", "figure_id": "fig_5", "figure_caption": "Figure 3 :3Figure 3: Root Mean Square Calibration Error values with temperature tuning and temperature tuning + OE across various datasets.", "figure_data": ""}, {"figure_label": "", "figure_type": "", "figure_id": "fig_6", "figure_caption": ".The Root Mean Square Calibration Error measures the square root of the expected squared difference between confidence and accuracy at a confidence level. It has the formula E C [(P(Y = Y |C = c) \u2212 c) 2 ] . A similar formulation which less severely penalizes large confidence-accuracy deviations is the Mean Absolute Value Calibration error, written E C [|P(Y = Y |C = c) \u2212 c|]. The MAD Calibration Error is a lower bound of the RMS Calibration Error. To empirically estimate these miscalibration measures, we partition the n samples of S into b bins {B 1 , B 2 , . . . , B b } with approximately 100 samples in each bin. UnlikeGuo et al. (2017), bins are not equally spaced since the distribution of confidence values is not uniform but dynamic. Concretely, the RMS Calibration Error is estimated with the numerically stable formula", "figure_data": ""}, {"figure_label": "4", "figure_type": "", "figure_id": "fig_7", "figure_caption": "Figure 4 :4Figure 4: ROC curves with Tiny ImageNet as D in and Textures, Places365, LSUN, and ImageNet as D test out . Figures show the curves corresponding to the maximum softmax probability (MSP) baseline detector and the MSP detector with Outlier Exposure (OE).", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_0", "figure_caption": "We use the ImageNet dataset with images from approximately 22 thousand classes as D OE WikiText-2 is a corpus of Wikipedia articles typically used for language modeling. We use WikiText-2 as D OE", "figure_data": "consists in 1, 803, 460 large-scalephotographs of scenes. Each photograph belongs to one of 365 classes.20 Newsgroups. 20 Newsgroups is a text classification dataset of newsgroup documents with 20classes and approximately 20, 000 examples split evenly among the classes. We use the standard60/40 train/test split.TREC. TREC is a question classification dataset with 50 fine-grained classes and 5, 952 individ-ual questions. We reserve 500 examples for the test set, and use the rest for training.SST. The Stanford Sentiment Treebank dataset (Socher et al., 2013) consists of movie reviewsexpressing positive or negative sentiment. SST has 8, 544 reviews for training and 2, 210 for testing.4.2.2 OUTLIER EXPOSURE DATASETS80 Million Tiny Images. 80 Million Tiny Images (Torralba et al., 2008) is a large-scale, diversedataset of 32\u00d732 natural images scrapped from the web. We use this dataset as D OE out for experimentswith SVHN, CIFAR-10, and CIFAR-100 as D in . We remove all examples of 80 Million Tiny Images which appear in the CIFAR datasets, so that D OE out and D test out are disjoint. In Section 5 we note thatonly a small fraction of this dataset is necessary for successful OE.ImageNet-22K."}, {"figure_label": "23", "figure_type": "table", "figure_id": "tab_1", "figure_caption": "8 in Appendix A. Notice that the SVHN classifier with OE can be used to detect new anomalies such as emojis and street view alphabet letters, even though D test OE is a dataset of natural images. Thus, Outlier Exposure helps models to generalize to unseen D test out distributions far better than the baseline. Comparisons between the MSP baseline and the MSP of the natural language classifier fine-tuned with OE. Results are percentages and averaged over 10 runs.Confidence Branch. A recently proposed OOD detection technique(DeVries & Taylor, 2018) involves appending an OOD scoring branch b : X \u2192 [0, 1] onto a deep network. Trained with samples from only D in , this branch estimates the network's confidence on any input. The creators of this technique made their code publicly available, so we use their code to train new 40-4 Wide Residual Network classifiers. We fine-tune the confidence branch with Outlier Exposure by adding 0.5E x\u223cD OE out[log b(x)] to the network's original optimization objective. In Table3, the baseline values are derived from the maximum softmax probabilities produced by the classifier trained with DeVries & Taylor (2018)'s publicly available training code. The confidence branch improves over this MSP detector, and after OE, the confidence branch detects anomalies more effectively. Comparison among the maximum softmax probability, Confidence Branch, and Confidence Branch + OE OOD detectors. The same network architecture is used for all three detectors. All results are percentages, and averaged across all D test out datasets.", "figure_data": "FPR95 \u2193AUROC \u2191AUPR \u2191D inMSP+OEMSP+OEMSP+OESVHN6.30.198.0100.091.199.9CIFAR-1034.99.589.397.859.290.5CIFAR-10062.738.573.187.930.158.2Tiny ImageNet66.314.064.992.227.279.3Places36563.528.266.590.633.171.0FPR90 \u2193AUROC \u2191AUPR \u2191D inMSP+OEMSP+OEMSP+OE20 Newsgroups42.44.982.797.749.991.9TREC43.50.882.199.352.297.6SST74.927.361.689.322.959.4FPR95 \u2193AUROC \u2191AUPR \u2191D inMSP Branch +OEMSP Branch +OEMSP Branch +OECIFAR-1049.338.720.884.486.993.751.948.666.6CIFAR-10055.647.942.077.681.285.536.544.454.7Tiny ImageNet64.366.920.165.363.490.630.325.775.2"}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_2", "figure_caption": "Comparison among the maximum softmax probability (MSP), MSP + GAN, and MSP + GAN + OE OOD detectors. The same network architecture is used for all three detectors. All results are percentages and averaged across all D test out datasets.", "figure_data": "FPR95 \u2193AUROC \u2191AUPR \u2191D inMSP +GAN +OEMSP +GAN +OEMSP +GAN +OECIFAR-1032.337.311.888.189.697.251.159.088.5CIFAR-10066.666.249.067.269.377.927.433.044.7Table 4: 4.4 DENSITY ESTIMATIONIn-Distribution"}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_3", "figure_caption": "Table 5: OOD detection results with a PixelCNN++ density estimator, and the same estimator after applying OE. The model's bits per pixel (BPP) scores each sample. All results are percentages. Test distributions D test out are described in Appendix A.", "figure_data": "test outBPP+OEBPP+OEBPP+OEGaussian0.00.0100.0100.0100.099.6Rademacher61.450.344.256.514.217.3Blobs17.21.393.299.560.096.2CIFAR-10Textures SVHN96.8 98.848.9 86.969.4 15.888.8 75.840.9 9.770.0 60.0Places36586.150.374.889.338.670.4LSUN76.943.276.490.936.572.4CIFAR-10096.189.852.468.519.041.9Mean66.646.465.883.739.966.0"}, {"figure_label": "66", "figure_type": "table", "figure_id": "tab_4", "figure_caption": "; expanded results and D test out descriptions are in Appendix F. In all cases, OE improves over the baseline, and the improvement is especially large for the word-level model.", "figure_data": "FPR90 \u2193AUROC \u2191AUPR \u2191D inBPC/BPW +OEBPC/BPW +OEBPC/BPW +OEPTB Characters99.089.477.586.376.086.7PTB Words48.50.9881.299.244.097.8"}, {"figure_label": "7", "figure_type": "table", "figure_id": "tab_6", "figure_caption": "", "figure_data": "are in"}, {"figure_label": "8", "figure_type": "table", "figure_id": "tab_7", "figure_caption": "NLP OOD example detection for the maximum softmax probability (MSP) baseline detector and the MSP detector after fine-tuning with Outlier Exposure (OE). All results are percentages and the result of 10 runs. Values are rounded so that 99.95% rounds to 100%.", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_8", "figure_caption": "C TRAINING FROM SCRATCH WITH OUTLIER EXPOSURE USUALLY IMPROVES DETECTION PERFORMANCE Elsewhere we show results for pre-trained networks that are fine-tuned with OE. However, a network trained from scratch which simultaneously trains with OE tends to give superior results. For example, a CIFAR-10 Wide ResNet trained normally obtains a classification error rate of 5.16% and an FPR95 of 34.94%. Fine-tuned, this network has an error rate of 5.27% and an FPR95 of 9.50%. Yet if we instead train the network from scratch and expose it to outliers as it trains, then the error rate is 4.26% and the FPR95 is 6.15%. This architecture corresponds to a 9.50% RMS calibration error with OE fine-tuning, but by training with OE from scratch the RMS calibration error is 6.15%. Compared to fine-tuning, training a network in tandem with OE tends to produce a network with a better error rate, calibration, and OOD detection performance. The reason why we use OE for fine-tuning is because training from scratch requires more time and sometimes more GPU memory than fine-tuning.", "figure_data": ""}, {"figure_label": "10", "figure_type": "table", "figure_id": "tab_10", "figure_caption": "", "figure_data": ": Comparison between the maximum softmax probability (MSP) and H(U; p) OOD scoringmethods on a network fine-tuned with OE. Results are percentages and an average of 10 runs.For example, CIFAR-10 results are averaged over \"Gaussian,\" \"Rademacher,\" . . ., or \"CIFAR-100\"measurements.F EXPANDED LANGUAGE MODELING RESULTSDetailed OOD detection results with language modeling datasets are shown in Table 11.FPR90 \u2193AUROC \u2191AUPR \u2191D inD test outBPC+OEBPC+OEBPC+OEAnswers96.949.9382.189.681.089.3Email99.590.6480.688.679.489.1PTB CharNewsgroup99.899.3975.285.073.385.5Reviews99.074.6480.889.079.289.6Weblog100.0100.068.979.267.380.1Mean99.089.477.586.376.086.7Answers41.43.6581.498.040.594.7Email64.90.1778.199.644.598.9PTB WordNewsgroup54.90.1777.899.539.898.3Reviews30.50.8588.098.953.696.8Weblog50.80.0880.799.941.599.7Mean48.50.9881.299.244.097.8"}, {"figure_label": "11", "figure_type": "table", "figure_id": "tab_11", "figure_caption": "OOD detection results on Penn Treebank examples and English Web Treebank outliers. All results are percentages.The D test out datasets come from the English Web Treebank(Bies et al., 2012), which contains text from five different domains: Yahoo! Answers, emails, newsgroups, product reviews, and weblogs. Other NLP D test out datasets we consider do not satisfy the language modeling assumption of continuity in the examples, so we do not evaluate on them.", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_12", "figure_caption": "Table 12: Calibration results for the temperature tuned baseline and temperature tuning + OE.", "figure_data": "RMS Calib. Error \u2193MAD Calib. Error \u2193Soft F1 Score \u2191D inTemperature +OETemperature +OETemperature +OESVHN22.34.810.92.452.187.9CIFAR-1019.49.312.65.639.969.7CIFAR-10014.78.211.36.552.865.8Tiny ImageNet12.06.99.04.862.972.2"}, {"figure_label": "13", "figure_type": "table", "figure_id": "tab_14", "figure_caption": "Calibration results for the softmax temperature tuning baseline, the same baseline after adding Posterior Rescaling, and temperature tuning + Posterior Rescaling + OE.", "figure_data": ""}], "formulas": [], "doi": ""}